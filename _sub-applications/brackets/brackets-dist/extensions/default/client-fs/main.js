!function(){function e(e,t,n,i,o,s){t[e]&&(n.push(e),(t[e]===!0||1===t[e])&&i.push(o+e+"/"+s))}function t(e,t,n,i,o){var s=i+t+"/"+o;require._fileExists(e.toUrl(s+".js"))&&n.push(s)}function n(e,t,i){var o;for(o in t)!t.hasOwnProperty(o)||e.hasOwnProperty(o)&&!i?"object"==typeof t[o]&&n(e[o],t[o],i):e[o]=t[o]}var i=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(o){var s=o.config?o.config():{};return{version:"2.0.1+",load:function(o,a,r,l){l=l||{},l.locale&&(s.locale=l.locale);var d,c,u,f=i.exec(o),p=f[1],h=f[4],m=f[5],g=h.split("-"),v=[],b={},T="";if(f[5]?(p=f[1],d=p+m):(d=o,m=f[4],h=s.locale,h||(h=s.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),g=h.split("-")),l.isBuild){for(v.push(d),t(a,"root",v,p,m),c=0;c<g.length;c++)u=g[c],T+=(T?"-":"")+u,t(a,T,v,p,m);a(v,function(){r()})}else a([d],function(t){var i,o=[];for(e("root",t,o,v,p,m),c=0;c<g.length;c++)i=g[c],T+=(T?"-":"")+i,e(T,t,o,v,p,m);a(v,function(){var e,i,s;for(e=o.length-1;e>-1&&o[e];e--)s=o[e],i=t[s],(i===!0||1===i)&&(i=a(p+s+"/"+m)),n(b,i);r(b)})})}}})}(),define("nls/strings",["require","exports","module"],function(e,t,n){n.exports={root:!0}}),define("nls/root/strings",{BUTTON_OPEN:"Open",BUTTON_SAVE:"Save",BUTTON_CANCEL:"Cancel",BUTTON_OPEN_FOLDER:"List contents",BUTTON_CREATE_FOLDER:"Create Folder ...",BUTTON_OK:"OK",BUTTON_REPLACE:"Replace",LABEL_FILE_NAME:"Name:",LABEL_FOLDER_NAME:"Folder Name",MSG_FILE_EXISTS:"There is already a file with the same name!",MSG_CONFIRM_REPLACE:'<p>The file <strong>"{0}"</strong> already exists in "{1}".  Replacing it will overwrite its contents.</p> Do you want to replace it?',TITLE_CONFIRM_REPLACE:"A file with the same name already exists."}),define("strings",["require","exports","module","i18n!nls/strings"],function(e,t,n){n.exports=e("i18n!nls/strings")}),define("text",["module"],function(e){var t,n,i,o,s,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,c=d&&location.protocol&&location.protocol.replace(/\:/,""),u=d&&location.hostname,f=d&&(location.port||void 0),p={},h=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(r,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:h.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=a[t];try{e=new ActiveXObject(n)}catch(i){}if(e){a=[n];break}}return e},parseName:function(e){var t,n,i,o=!1,s=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==s&&(!a||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,i=n||t,s=i.indexOf("!"),-1!==s&&(o="strip"===i.substring(s+1),i=i.substring(0,s),n?n=i:t=i),{moduleName:t,ext:n,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,o){var s,a,r,l=t.xdRegExp.exec(e);return l?(s=l[2],a=l[3],a=a.split(":"),r=a[1],a=a[0],!(s&&s!==n||a&&a.toLowerCase()!==i.toLowerCase()||(r||a)&&r!==o)):!0},finishLoad:function(e,n,i,o){i=n?t.strip(i):i,h.isBuild&&(p[e]=i),o(i)},load:function(e,n,i,o){if(o.isBuild&&!o.inlineText)return void i();h.isBuild=o.isBuild;var s=t.parseName(e),a=s.moduleName+(s.ext?"."+s.ext:""),r=n.toUrl(a),l=h.useXhr||t.useXhr;return 0===r.indexOf("empty:")?void i():void(!d||l(r,c,u,f)?t.get(r,function(n){t.finishLoad(e,s.strip,n,i)},function(e){i.error&&i.error(e)}):n([a],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,i)}))},write:function(e,n,i){if(p.hasOwnProperty(n)){var o=t.jsEscape(p[n]);i.asModule(e+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,n,i,o,s){var a=t.parseName(n),r=a.ext?"."+a.ext:"",l=a.moduleName+r,d=i.toUrl(a.moduleName+r)+".js";t.load(l,i,function(){var n=function(e){return o(d,e)};n.asModule=function(e,t){return o.asModule(e,d,t)},t.write(e,l,n,s)},s)}},"node"===h.env||!h.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=require.nodeRequire("fs"),t.get=function(e,t,i){try{var o=n.readFileSync(e,"utf8");0===o.indexOf("ï»¿")&&(o=o.substring(1)),t(o)}catch(s){i(s)}}):"xhr"===h.env||!h.env&&t.createXhr()?t.get=function(e,n,i,o){var s,a=t.createXhr();if(a.open("GET",e,!0),o)for(s in o)o.hasOwnProperty(s)&&a.setRequestHeader(s.toLowerCase(),o[s]);h.onXhr&&h.onXhr(a,e),a.onreadystatechange=function(){var t,o;4===a.readyState&&(t=a.status,t>399&&600>t?(o=new Error(e+" HTTP status: "+t),o.xhr=a,i(o)):n(a.responseText),h.onXhrComplete&&h.onXhrComplete(a,e))},a.send(null)}:"rhino"===h.env||!h.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,o="utf-8",s=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),r=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),o)),l="";try{for(n=new java.lang.StringBuffer,i=r.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=r.readLine());)n.append(a),n.append(i);l=String(n.toString())}finally{r.close()}t(l)}:("xpconnect"===h.env||!h.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,o=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var n,a,r,l={};s&&(e=e.replace(/\//g,"\\")),r=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream),n.init(r,1,0,!1),a=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream),a.init(n,"utf-8",n.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(n.available(),l),a.close(),n.close(),t(l.value)}catch(d){throw new Error((r&&r.path||"")+": "+d)}}),t}),define("text!templates/contents.html",[],function(){return'<div id="rfs-trail">\n    <ul>\n        {{#trail}}<li {{#curr}}class="{{curr}}"{{/curr}} data-path="{{path}}">{{name}}</li>{{/trail}}\n    </ul>\n</div>\n<div id="rfs-files-list">\n    <table class="bottom-panel-table table table-striped table-condensed">\n        <tbody>\n            {{#files}}\n            <tr class="rfs-file {{disabled}}" data-path="{{fullPath}}" title={{fullPath}}>\n                <td class="icons-column">\n                    <div class="rfs-icon {{type}}" {{#isDirectory}}title="{{OPEN_FOLDER}}"{{/isDirectory}}></div>\n                </td>\n                <td>{{name}}</td>\n            </tr>\n            {{/files}}\n        </tbody>\n    </table>\n</div>\n'}),define("lib/contents",["require","exports","module","../strings","text!../templates/contents.html"],function(e,t,n){function i(e,t,n,o,s,a,r,l,d){if(!(this instanceof i))return new i(e,t,n,o,s,a,r,l,d);var c=this;this.allowMultipleSelection=t,this.chooseDirectories=n,this.title=o,this.initialPath=s,this.fileTypes=a,this.proposedNewFilename=r,this.onError=l,this.onSelected=d,this.$contents=e.find("#rfs-contents"),this.$saveName=e.find("#rfs-save-name"),this.$contents.on("click",function(e){c.selectRow(e)}),this.$contents.on("dblclick",function(e){c.openFolder(e)}),this.btnOk=e.find("button[data-button-id='ok']")[0],this.selected={},this.resetTrail(s),this.showFiles(s)}var o=brackets.getModule("file/FileUtils"),s=brackets.getModule("filesystem/FileSystem"),a=e("../strings"),r=e("text!../templates/contents.html");i.prototype.isDirSelected=function(){return this.chooseDirectories&&this.currTrail&&o.stripTrailingSlash(this.currTrail.path)!==o.stripTrailingSlash(this.initialPath)},i.prototype.setSelected=function(e,t){this.selected[e]=t,this.allowMultipleSelection||this.$saveName.text(o.stripTrailingSlash(e))},i.prototype.deselectRow=function(e){e.children().removeClass("selected"),delete this.selected[e.attr("data-path")],this.$saveName.text(""),this.isDirSelected()&&this.setSelected(this.currTrail.path,!0),0===Object.keys(this.selected).length&&(this.btnOk.disabled=!0)},i.prototype.deselectAll=function(){var e=Object.keys(this.selected),t=this;e.length&&(e.forEach(function(e){var n=t.selected[e];n.children&&n.children().removeClass("selected")}),this.selected={},this.btnOk.disabled=!0)},i.prototype.selectRow=function(e){var t=e.target.parentElement,n=$("TR"===t.tagName?t:t.parentElement),i=n.attr("data-path"),s=n.find(".dir");e.stopImmediatePropagation(),i&&(this.onSelected?s.length||this.onSelected({path:this.currTrail.path,fileName:o.getBaseName(i)}):this.selected[i]?this.deselectRow(n):(this.chooseDirectories&&s.length||!this.chooseDirectories&&!s.length)&&(this.allowMultipleSelection||this.deselectAll(),n.children().addClass("selected"),this.setSelected(i,n),this.btnOk.disabled&&(this.btnOk.disabled=!1)))},i.prototype.resetTrail=function(e){var t=e.split("/"),n="",i=this;this.trail=[],this.currTrail=null,t.forEach(function(e){e&&(n+="/"+e,i.trail.push({name:e,path:n}))})},i.prototype.openFolder=function(e){var t=e.target.parentElement,n="TR"===t.tagName?t:t.parentElement,i=$(n),o=i.attr("data-path"),s=i.find(".dir");e.stopImmediatePropagation(),o&&s.length&&(this.resetTrail(o),this.showFiles(o))},i.prototype.openTrail=function(e){e.stopImmediatePropagation(),this.showFiles($(e.target).attr("data-path"))},i.prototype.showFiles=function(e){var t=s.getDirectoryForPath(e),n=this;this.selected={},this.$saveName.text(""),this.onSelected||(this.btnOk.disabled=!0),t.getContents(function(t,i){var s=[],l={OPEN_FOLDER:a.BUTTON_OPEN_FOLDER,multiSelect:n.allowMultipleSelection,chooseDir:n.chooseDirectories};t?n.onError(t):(i.forEach(function(e){var t={name:e.name,fullPath:e.fullPath,isFile:e.isFile,isDirectory:e.isDirectory,type:e.isDirectory?"dir":"file"};n.chooseDirectories&&e.isFile&&(t.disabled="rfs-disabled"),s.push(t)}),s.sort(function(e,t){return e.type===t.type?e.name.toLowerCase().localeCompare(t.name.toLowerCase()):e.type<t.type?-1:1}),n.files=s,e=o.stripTrailingSlash(e),n.trail.forEach(function(t){t.path===e?(t.curr="curr",n.currTrail=t,n.onSelected&&n.onSelected({path:t.path})):t.curr&&delete t.curr}),n.isDirSelected()&&(n.setSelected(n.currTrail.path,!0),n.btnOk.disabled=!1),l.files=s,l.trail=n.trail,n.$contents.html(Mustache.render(r,l)),n.$contents.on("click",".rfs-icon.dir",function(e){n.openFolder(e)}),n.$contents.on("click","#rfs-trail > ul > li",function(e){n.openTrail(e)}))})},i.prototype.getSelected=function(){return Object.keys(this.selected)},n.exports=i}),define("text!templates/open-dialog.html",[],function(){return'<div id="rfs-files-dialog" class="modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{TITLE}}</h1>\n    </div>\n    <div class="modal-body">\n        <div id="rfs-contents"></div>\n    </div>\n    <div class="modal-footer">\n        <span id="rfs-save-name"></span>\n        <button data-button-id="cancel" class="dialog-button btn cancel btn-80" >{{BUTTON_CANCEL}}</button>\n        <button data-button-id="ok" class="dialog-button btn primary btn-80">{{BUTTON_OPEN}}</button>\n    </div>\n</div>\n'}),define("lib/open-dialog",["require","exports","module","../strings","./contents","text!../templates/open-dialog.html"],function(e,t){var n=brackets.getModule("widgets/Dialogs"),i=e("../strings"),o=e("./contents"),s=e("text!../templates/open-dialog.html");t.show=function(e,t,a,r,l,d){0===r.indexOf("/samples/")&&(r=null);var c={TITLE:a,BUTTON_CANCEL:i.BUTTON_CANCEL,BUTTON_OPEN:i.BUTTON_OPEN},u=r||brackets.app.getUserDocumentsDirectory(),f=n.showModalDialogUsingTemplate(Mustache.render(s,c)),p=f.getElement(),h=o(p,e,t,a,u,l,null,d,null);f.done(function(e){"ok"===e&&d(null,h.getSelected())})}}),define("text!templates/create-folder.html",[],function(){return'<div id="rfs-create-folder-dialog" class="modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{TITLE}}</h1>\n    </div>\n    <div class="modal-body rfs-body">\n        <input type="text" id="rfs-folder-name" />\n        <span id="rfs-msg">&nbsp;</span>\n    </div>\n    <div class="modal-footer">\n        <button data-button-id="cancel" class="dialog-button btn cancel btn-80" >{{BUTTON_CANCEL}}</button>\n        <button data-button-id="ok" class="dialog-button btn primary btn-80">{{BUTTON_OK}}</button>\n    </div>\n</div>\n'}),define("lib/create-folder",["require","exports","module","../strings","text!../templates/create-folder.html"],function(e,t){var n=brackets.getModule("widgets/Dialogs"),i=e("../strings"),o=e("text!../templates/create-folder.html");t.show=function(e,t){var s={TITLE:i.LABEL_FOLDER_NAME,BUTTON_CANCEL:i.BUTTON_CANCEL,BUTTON_OK:i.BUTTON_OK},a=n.showModalDialogUsingTemplate(Mustache.render(o,s)),r=a.getElement(),l=r.find("button[data-button-id='ok']")[0],d=r.find("#rfs-folder-name"),c=r.find("#rfs-msg");l.disabled=!0,d.focus(),d.keyup(function(){var t=d.val().trim(),n=-1!==$.inArray(t,e);!t||n?l.disabled=!0:l.disabled&&(l.disabled=!1),n?c.text(i.MSG_FILE_EXISTS):"&nbsp;"!==c.html()&&c.html("&nbsp;")}),a.done(function(e){"ok"===e&&t(d.val().trim())})}}),define("text!templates/confirm-replace.html",[],function(){return'<div id="rfs-create-folder-dialog" class="modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{TITLE}}</h1>\n    </div>\n    <div class="modal-body rfs-body">{{{REPLACE_MESSAGE}}}</div>\n    <div class="modal-footer">\n        <button data-button-id="cancel" class="dialog-button btn cancel btn-80" >{{BUTTON_CANCEL}}</button>\n        <button data-button-id="ok" class="dialog-button btn primary btn-80">{{BUTTON_REPLACE}}</button>\n    </div>\n</div>\n'}),define("lib/confirm-replace",["require","exports","module","../strings","text!../templates/confirm-replace.html"],function(e,t){var n=brackets.getModule("widgets/Dialogs"),i=brackets.getModule("utils/StringUtils"),o=e("../strings"),s=e("text!../templates/confirm-replace.html");t.show=function(e,t,a){var r={TITLE:o.TITLE_CONFIRM_REPLACE,REPLACE_MESSAGE:i.format(o.MSG_CONFIRM_REPLACE,t,e),BUTTON_CANCEL:o.BUTTON_CANCEL,BUTTON_REPLACE:o.BUTTON_REPLACE},l=n.showModalDialogUsingTemplate(Mustache.render(s,r));l.done(a)}}),define("text!templates/save-dialog.html",[],function(){return'<div id="rfs-files-dialog" class="modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{TITLE}}</h1>\n    </div>\n    <div class="modal-body">\n        <label for="rfs-file-name">{{LABEL_FILE_NAME}}</label><input type="text" id="rfs-file-name" value="{{proposed}}" />\n        <button id="rfs-create-folder" class="dialog-button btn right">{{BUTTON_CREATE_FOLDER}}</button>\n        <div id="rfs-contents"></div>\n    </div>\n    <div class="modal-footer">\n        <span id="rfs-save-name"></span>\n        <button data-button-id="cancel" class="dialog-button btn cancel btn-80" >{{BUTTON_CANCEL}}</button>\n        <button data-button-id="ok" class="dialog-button btn primary btn-80">{{BUTTON_SAVE}}</button>\n    </div>\n</div>\n'}),define("lib/save-dialog",["require","exports","module","../strings","./create-folder","./confirm-replace","./contents","text!../templates/save-dialog.html"],function(e,t){var n=brackets.getModule("widgets/Dialogs"),i=brackets.getModule("filesystem/FileSystem"),o=brackets.getModule("file/FileUtils"),s=e("../strings"),a=e("./create-folder"),r=e("./confirm-replace"),l=e("./contents"),d=e("text!../templates/save-dialog.html");t.show=function(e,t,c,u){function f(){return o.stripTrailingSlash(v)+"/"+O.val().trim()}function p(){O.val().trim()?E.disabled&&(E.disabled=!1):E.disabled=!0,N.text(f())}function h(e){e.path&&(v=e.path),e.fileName&&(O.val(e.fileName),p()),N.text(f())}0===t.indexOf("/samples/")&&(t=null);var m,g={TITLE:e,BUTTON_CANCEL:s.BUTTON_CANCEL,BUTTON_SAVE:s.BUTTON_SAVE,LABEL_FILE_NAME:s.LABEL_FILE_NAME,OPEN_FOLDER:s.BUTTON_OPEN_FOLDER,BUTTON_CREATE_FOLDER:s.BUTTON_CREATE_FOLDER,proposed:c},v=t||brackets.app.getUserDocumentsDirectory(),b=n.showModalDialogUsingTemplate(Mustache.render(d,g)),T=b.getElement(),E=T.find("button[data-button-id='ok']")[0],O=T.find("#rfs-file-name"),N=T.find("#rfs-save-name"),y=T.find("#rfs-create-folder");O.keyup(p),y.click(function(t){t.stopImmediatePropagation();var n=[];m.files.forEach(function(e){n.push(e.name)}),a.show(n,function(t){var n=o.stripTrailingSlash(v)+"/"+t,s=i.getDirectoryForPath(n);s.create(function(t){return t?u(t):(v=n,void(m=l(T,!1,!1,e,v,null,null,u,h)))})})}),m=l(T,!1,!1,e,v,null,null,u,h),b.done(function(e){if("ok"===e){var t=f(),n=i.getFileForPath(t);n.exists(function(e,n){return e?u(e):void(n?r.show(v,O.val().trim(),function(e){"ok"===e&&u(null,t)}):u(null,t))})}})}}),define("main",["require","exports","module","./lib/open-dialog","./lib/save-dialog"],function(e,t,n){function i(){}var o=brackets.getModule("utils/ExtensionUtils"),s=brackets.getModule("fileSystemImpl");o.loadStyleSheet(n,"styles/dialog.less"),s._setDialogs?s._setDialogs(e("./lib/open-dialog"),e("./lib/save-dialog")):i()});