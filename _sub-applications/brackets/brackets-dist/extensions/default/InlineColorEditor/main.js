!function(e){function t(e,p){var b,v,_,y,k,e=e?e:"";if("object"==typeof e&&e.hasOwnProperty("_tc_id"))return e;v=e,k=y=_=255;var $=1,O=b=!1;if("string"==typeof v)e:{v=v.replace(l,"").replace(d,"").toLowerCase();var x=!1;if(m[v])v=m[v],x=!0;else if("transparent"==v){v={r:0,g:0,b:0,a:0};break e}var H;v=(H=C.rgb.exec(v))?{r:H[1],g:H[2],b:H[3]}:(H=C.rgba.exec(v))?{r:H[1],g:H[2],b:H[3],a:H[4]}:(H=C.hsl.exec(v))?{h:H[1],s:H[2],l:H[3]}:(H=C.hsla.exec(v))?{h:H[1],s:H[2],l:H[3],a:H[4]}:(H=C.hsv.exec(v))?{h:H[1],s:H[2],v:H[3]}:(H=C.hex6.exec(v))?{r:parseInt(H[1],16),g:parseInt(H[2],16),b:parseInt(H[3],16),format:x?"name":"hex"}:(H=C.hex3.exec(v))?{r:parseInt(H[1]+""+H[1],16),g:parseInt(H[2]+""+H[2],16),b:parseInt(H[3]+""+H[3],16),format:x?"name":"hex"}:!1}"object"==typeof v&&(v.hasOwnProperty("r")&&v.hasOwnProperty("g")&&v.hasOwnProperty("b")?(_=255*i(v.r,255),y=255*i(v.g,255),k=255*i(v.b,255),b=!0,O="%"===String(v.r).substr(-1)?"prgb":"rgb"):v.hasOwnProperty("h")&&v.hasOwnProperty("s")&&v.hasOwnProperty("v")?(v.s=a(v.s),v.v=a(v.v),b=v.h,y=v.s,k=v.v,b=6*i(b,360),y=i(y,100),k=i(k,100),_=h.floor(b),H=b-_,b=k*(1-y),O=k*(1-H*y),H=k*(1-(1-H)*y),x=_%6,_=255*[k,O,b,b,H,k][x],y=255*[H,k,k,O,b,b][x],k=255*[b,b,H,k,k,O][x],b=!0,O="hsv"):v.hasOwnProperty("h")&&v.hasOwnProperty("s")&&v.hasOwnProperty("l")&&(v.s=a(v.s),v.l=a(v.l),_=v.h,b=v.s,k=v.l,y=function(e,t,o){return 0>o&&(o+=1),o>1&&(o-=1),1/6>o?e+6*(t-e)*o:.5>o?t:2/3>o?e+6*(t-e)*(2/3-o):e},_=i(_,360),b=i(b,100),k=i(k,100),0==b?b=k=O=k:(O=.5>k?k*(1+b):k+b-k*b,H=2*k-O,b=y(H,O,_+1/3),k=y(H,O,_),O=y(H,O,_-1/3)),_=255*b,y=255*k,k=255*O,b=!0,O="hsl"),v.hasOwnProperty("a"))&&($=v.a),v=v.format||O,_=f(255,g(_,0)),y=f(255,g(y,0)),k=f(255,g(k,0));var S=_,R=y,E=k,T=parseFloat($),D=u(100*T)/100;return 1>S&&(S=u(S)),1>R&&(R=u(R)),1>E&&(E=u(E)),{ok:b,format:v,_tc_id:c++,alpha:T,toHsv:function(){var e=r(S,R,E);return{h:360*e.h,s:e.s,v:e.v,a:T}},toHsvString:function(){var e=r(S,R,E),t=u(360*e.h),o=u(100*e.s),e=u(100*e.v);return 1==T?"hsv("+t+", "+o+"%, "+e+"%)":"hsva("+t+", "+o+"%, "+e+"%, "+D+")"},toHsl:function(){var e=o(S,R,E);return{h:360*e.h,s:e.s,l:e.l,a:T}},toHslString:function(){var e=o(S,R,E),t=u(360*e.h),r=u(100*e.s),e=u(100*e.l);return 1==T?"hsl("+t+", "+r+"%, "+e+"%)":"hsla("+t+", "+r+"%, "+e+"%, "+D+")"},toHex:function(){return n(S,R,E)},toHexString:function(){return"#"+n(S,R,E)},toRgb:function(){return{r:u(S),g:u(R),b:u(E),a:T}},toRgbString:function(){return 1==T?"rgb("+u(S)+", "+u(R)+", "+u(E)+")":"rgba("+u(S)+", "+u(R)+", "+u(E)+", "+D+")"},toPercentageRgb:function(){return{r:u(100*i(S,255))+"%",g:u(100*i(R,255))+"%",b:u(100*i(E,255))+"%",a:T}},toPercentageRgbString:function(){return 1==T?"rgb("+u(100*i(S,255))+"%, "+u(100*i(R,255))+"%, "+u(100*i(E,255))+"%)":"rgba("+u(100*i(S,255))+"%, "+u(100*i(R,255))+"%, "+u(100*i(E,255))+"%, "+D+")"},toName:function(){return w[n(S,R,E)]||!1},toFilter:function(){var e=secondHex=n(S,R,E),o=secondAlphaHex=Math.round(255*parseFloat(T)).toString(16),r=p&&p.gradientType?"GradientType = 1, ":"";if(secondColor){var i=t(secondColor);secondHex=i.toHex(),secondAlphaHex=Math.round(255*parseFloat(i.alpha)).toString(16)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr=#"+s(o)+e+",endColorstr=#"+s(secondAlphaHex)+secondHex+")"},toString:function(e){var e=e||this.format,t=!1;return"rgb"===e&&(t=this.toRgbString()),"prgb"===e&&(t=this.toPercentageRgbString()),"hex"===e&&(t=this.toHexString()),"name"===e&&(t=this.toName()),"hsl"===e&&(t=this.toHslString()),"hsv"===e&&(t=this.toHsvString()),t||this.toHexString()}}}function o(e,t,o){var r,e=i(e,255),t=i(t,255),o=i(o,255),n=g(e,t,o),s=f(e,t,o),a=(n+s)/2;if(n==s)r=s=0;else{var l=n-s,s=a>.5?l/(2-n-s):l/(n+s);switch(n){case e:r=(t-o)/l+(o>t?6:0);break;case t:r=(o-e)/l+2;break;case o:r=(e-t)/l+4}r/=6}return{h:r,s:s,l:a}}function r(e,t,o){var r,e=i(e,255),t=i(t,255),o=i(o,255),n=g(e,t,o),s=f(e,t,o),a=n-s;if(n==s)r=0;else{switch(n){case e:r=(t-o)/a+(o>t?6:0);break;case t:r=(o-e)/a+2;break;case o:r=(e-t)/a+4}r/=6}return{h:r,s:0==n?0:a/n,v:n}}function n(e,t,o){return e=[s(u(e).toString(16)),s(u(t).toString(16)),s(u(o).toString(16))],e[0][0]==e[0][1]&&e[1][0]==e[1][1]&&e[2][0]==e[2][1]?e[0][0]+e[1][0]+e[2][0]:e.join("")}function i(e,t){"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)&&(e="100%");var o="string"==typeof e&&-1!=e.indexOf("%"),e=f(t,g(0,parseFloat(e)));return o&&(e=parseInt(e*t)/100),1e-6>h.abs(e-t)?1:e%t/parseFloat(t)}function s(e){return 1==e.length?"0"+e:""+e}function a(e){return 1>=e&&(e=100*e+"%"),e}var l=/^[\s,#]+/,d=/\s+$/,c=0,h=Math,u=h.round,f=h.min,g=h.max,p=h.random;t.fromRatio=function(e){if("object"==typeof e){var o,r={};for(o in e)r[o]=a(e[o]);e=r}return t(e)},t.equals=function(e,o){return e&&o?t(e).toRgbString()==t(o).toRgbString():!1},t.random=function(){return t.fromRatio({r:p(),g:p(),b:p()})},t.desaturate=function(e,o){var r=t(e).toHsl();return r.s-=(o||10)/100,r.s=f(1,g(0,r.s)),t(r)},t.saturate=function(e,o){var r=t(e).toHsl();return r.s+=(o||10)/100,r.s=f(1,g(0,r.s)),t(r)},t.greyscale=function(e){return t.desaturate(e,100)},t.lighten=function(e,o){var r=t(e).toHsl();return r.l+=(o||10)/100,r.l=f(1,g(0,r.l)),t(r)},t.darken=function(e,o){var r=t(e).toHsl();return r.l-=(o||10)/100,r.l=f(1,g(0,r.l)),t(r)},t.complement=function(e){return e=t(e).toHsl(),e.h=(e.h+180)%360,t(e)},t.triad=function(e){var o=t(e).toHsl(),r=o.h;return[t(e),t({h:(r+120)%360,s:o.s,l:o.l}),t({h:(r+240)%360,s:o.s,l:o.l})]},t.tetrad=function(e){var o=t(e).toHsl(),r=o.h;return[t(e),t({h:(r+90)%360,s:o.s,l:o.l}),t({h:(r+180)%360,s:o.s,l:o.l}),t({h:(r+270)%360,s:o.s,l:o.l})]},t.splitcomplement=function(e){var o=t(e).toHsl(),r=o.h;return[t(e),t({h:(r+72)%360,s:o.s,l:o.l}),t({h:(r+216)%360,s:o.s,l:o.l})]},t.analogous=function(e,o,r){var o=o||6,r=r||30,n=t(e).toHsl(),r=360/r,e=[t(e)];for(n.h=(n.h-(r*o>>1)+720)%360;--o;)n.h=(n.h+r)%360,e.push(t(n));return e},t.monochromatic=function(e,o){for(var o=o||6,r=t(e).toHsv(),n=r.h,i=r.s,r=r.v,s=[],a=1/o;o--;)s.push(t({h:n,s:i,v:r})),r=(r+a)%1;return s},t.readable=function(e,o){var r=t(e).toRgb(),n=t(o).toRgb();return 10404<(n.r-r.r)*(n.r-r.r)+(n.g-r.g)*(n.g-r.g)+(n.b-r.b)*(n.b-r.b)};var b,m=t.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},v=t,_=m,y={};for(b in _)_.hasOwnProperty(b)&&(y[_[b]]=b);var C,w=v.hexNames=y;C={rgb:RegExp("rgb[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),rgba:RegExp("rgba[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hsl:RegExp("hsl[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hsla:RegExp("hsla[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hsv:RegExp("hsv[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/},"undefined"!=typeof module&&module.exports?module.exports=t:e.tinycolor=t}(this),define("thirdparty/tinycolor-min",function(){}),define("text",["module"],function(e){var t,o,r,n,i,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,c=d&&location.protocol&&location.protocol.replace(/\:/,""),h=d&&location.hostname,u=d&&(location.port||void 0),f={},g=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(a,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:g.createXhr||function(){var e,t,o;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){o=s[t];try{e=new ActiveXObject(o)}catch(r){}if(e){s=[o];break}}return e},parseName:function(e){var t,o,r,n=!1,i=e.indexOf("."),s=0===e.indexOf("./")||0===e.indexOf("../");return-1!==i&&(!s||i>1)?(t=e.substring(0,i),o=e.substring(i+1,e.length)):t=e,r=o||t,i=r.indexOf("!"),-1!==i&&(n="strip"===r.substring(i+1),r=r.substring(0,i),o?o=r:t=r),{moduleName:t,ext:o,strip:n}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,o,r,n){var i,s,a,l=t.xdRegExp.exec(e);return l?(i=l[2],s=l[3],s=s.split(":"),a=s[1],s=s[0],!(i&&i!==o||s&&s.toLowerCase()!==r.toLowerCase()||(a||s)&&a!==n)):!0},finishLoad:function(e,o,r,n){r=o?t.strip(r):r,g.isBuild&&(f[e]=r),n(r)},load:function(e,o,r,n){if(n.isBuild&&!n.inlineText)return void r();g.isBuild=n.isBuild;var i=t.parseName(e),s=i.moduleName+(i.ext?"."+i.ext:""),a=o.toUrl(s),l=g.useXhr||t.useXhr;return 0===a.indexOf("empty:")?void r():void(!d||l(a,c,h,u)?t.get(a,function(o){t.finishLoad(e,i.strip,o,r)},function(e){r.error&&r.error(e)}):o([s],function(e){t.finishLoad(i.moduleName+"."+i.ext,i.strip,e,r)}))},write:function(e,o,r){if(f.hasOwnProperty(o)){var n=t.jsEscape(f[o]);r.asModule(e+"!"+o,"define(function () { return '"+n+"';});\n")}},writeFile:function(e,o,r,n,i){var s=t.parseName(o),a=s.ext?"."+s.ext:"",l=s.moduleName+a,d=r.toUrl(s.moduleName+a)+".js";t.load(l,r,function(){var o=function(e){return n(d,e)};o.asModule=function(e,t){return n.asModule(e,d,t)},t.write(e,l,o,i)},i)}},"node"===g.env||!g.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(o=require.nodeRequire("fs"),t.get=function(e,t,r){try{var n=o.readFileSync(e,"utf8");0===n.indexOf("﻿")&&(n=n.substring(1)),t(n)}catch(i){r(i)}}):"xhr"===g.env||!g.env&&t.createXhr()?t.get=function(e,o,r,n){var i,s=t.createXhr();if(s.open("GET",e,!0),n)for(i in n)n.hasOwnProperty(i)&&s.setRequestHeader(i.toLowerCase(),n[i]);g.onXhr&&g.onXhr(s,e),s.onreadystatechange=function(){var t,n;4===s.readyState&&(t=s.status,t>399&&600>t?(n=new Error(e+" HTTP status: "+t),n.xhr=s,r(n)):o(s.responseText),g.onXhrComplete&&g.onXhrComplete(s,e))},s.send(null)}:"rhino"===g.env||!g.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var o,r,n="utf-8",i=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(i),n)),l="";try{for(o=new java.lang.StringBuffer,r=a.readLine(),r&&r.length()&&65279===r.charAt(0)&&(r=r.substring(1)),null!==r&&o.append(r);null!==(r=a.readLine());)o.append(s),o.append(r);l=String(o.toString())}finally{a.close()}t(l)}:("xpconnect"===g.env||!g.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,n=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),i="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var o,s,a,l={};i&&(e=e.replace(/\//g,"\\")),a=new FileUtils.File(e);try{o=r["@mozilla.org/network/file-input-stream;1"].createInstance(n.nsIFileInputStream),o.init(a,1,0,!1),s=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(n.nsIConverterInputStream),s.init(o,"utf-8",o.available(),n.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(o.available(),l),s.close(),o.close(),t(l.value)}catch(d){throw new Error((a&&a.path||"")+": "+d)}}),t}),define("text!ColorEditorTemplate.html",[],function(){return'\n<div tabindex="-1" class="color-editor">\n  <section>\n    <div class="sliders">\n      <div class="color-selection-field">\n        <div class="saturation-gradient gradient-overlay"></div>\n        <div class="luminosity-gradient gradient-overlay"></div>\n        <div tabindex="0" class="selector-base">\n          <div class="selector"></div>\n        </div>\n      </div>\n      <div class="hue-slider slider">\n        <div tabindex="0" class="selector-base">\n          <div class="selector"></div>\n        </div>\n      </div>\n      <div class="opacity-slider slider">\n        <div class="opacity-gradient gradient-overlay"></div>\n        <div tabindex="0" class="selector-base">\n          <div class="selector"></div>\n        </div>\n      </div>\n    </div>\n    <footer>\n      <input class="color-value" />\n      <ul class="button-bar">\n        <li class="selected" title="{{COLOR_EDITOR_RGBA_BUTTON_TIP}}"><a href="#" tabindex="0" class="rgba">RGBa</a></li>\n        <li title="{{COLOR_EDITOR_HEX_BUTTON_TIP}}"><a href="#" tabindex="0" class="hex">Hex</a></li>\n        <li title="{{COLOR_EDITOR_HSLA_BUTTON_TIP}}"><a href="#" tabindex="0" class="hsla">HSLa</a></li>\n      </ul>\n    </footer>\n  </section>\n  <aside>\n    <header>\n      <div class="large-swatches">\n        <div class="current-color large-swatch" title="{{COLOR_EDITOR_CURRENT_COLOR_SWATCH_TIP}}"></div>\n        <div class="original-color large-swatch" title="{{COLOR_EDITOR_ORIGINAL_COLOR_SWATCH_TIP}}"></div>\n      </div>\n    </header>\n    <ul class="swatches"></ul>\n  </aside>\n</div>'}),define("ColorEditor",["require","exports","module","thirdparty/tinycolor-min","text!ColorEditorTemplate.html"],function(e,t){function o(e,t,o,r){this.$element=$(Mustache.render(a,s)),e.append(this.$element),this._callback=o,this._handleKeydown=this._handleKeydown.bind(this),this._handleOpacityKeydown=this._handleOpacityKeydown.bind(this),this._handleHslKeydown=this._handleHslKeydown.bind(this),this._handleHueKeydown=this._handleHueKeydown.bind(this),this._handleSelectionKeydown=this._handleSelectionKeydown.bind(this),this._handleOpacityDrag=this._handleOpacityDrag.bind(this),this._handleHueDrag=this._handleHueDrag.bind(this),this._handleSelectionFieldDrag=this._handleSelectionFieldDrag.bind(this),this._color=tinycolor(t),this._originalColor=t,this._redoColor=null,this.$colorValue=this.$element.find(".color-value"),this.$buttonList=this.$element.find("ul.button-bar"),this.$rgbaButton=this.$element.find(".rgba"),this.$hexButton=this.$element.find(".hex"),this.$hslButton=this.$element.find(".hsla"),this.$currentColor=this.$element.find(".current-color"),this.$originalColor=this.$element.find(".original-color"),this.$selection=this.$element.find(".color-selection-field"),this.$selectionBase=this.$element.find(".color-selection-field .selector-base"),this.$hueBase=this.$element.find(".hue-slider .selector-base"),this.$opacityGradient=this.$element.find(".opacity-gradient"),this.$hueSlider=this.$element.find(".hue-slider"),this.$hueSelector=this.$element.find(".hue-slider .selector-base"),this.$opacitySlider=this.$element.find(".opacity-slider"),this.$opacitySelector=this.$element.find(".opacity-slider .selector-base"),this.$swatches=this.$element.find(".swatches"),this._addSwatches(r),this._addListeners(),this.$originalColor.css("background-color",this._originalColor),this._commitColor(t)}function r(e,t,o){var r=e-t;return r=Math.min(o,Math.max(0,r))}e("thirdparty/tinycolor-min");var n=brackets.getModule("utils/KeyEvent"),i=brackets.getModule("utils/StringUtils"),s=brackets.getModule("strings"),a=e("text!ColorEditorTemplate.html"),l=5;o.prototype._color=null,o.prototype._hsv=tinycolor("rgba(0,0,0,1)").toHsv(),o.prototype._redoColor=null,o.prototype._originalColor=null,o.prototype.getRootElement=function(){return this.$element},o.prototype._addListeners=function(){this._bindColorFormatToRadioButton("rgba"),this._bindColorFormatToRadioButton("hex"),this._bindColorFormatToRadioButton("hsla"),this._bindInputHandlers(),this._bindOriginalColorButton(),this._registerDragHandler(this.$selection,this._handleSelectionFieldDrag),this._registerDragHandler(this.$hueSlider,this._handleHueDrag),this._registerDragHandler(this.$opacitySlider,this._handleOpacityDrag),this._bindKeyHandler(this.$selectionBase,this._handleSelectionKeydown),this._bindKeyHandler(this.$hueBase,this._handleHueKeydown),this._bindKeyHandler(this.$opacitySelector,this._handleOpacityKeydown),this._bindKeyHandler(this.$hslButton,this._handleHslKeydown),this._bindKeyHandler(this.$element,this._handleKeydown)},o.prototype._synchronize=function(){var e=this.getColor().toString(),t=tinycolor(e),o="hsl("+this._hsv.h+", 100%, 50%)";this._updateColorTypeRadioButtons(t.format),this.$colorValue.val(e),this.$currentColor.css("background-color",e),this.$selection.css("background-color",o),this.$hueBase.css("background-color",o),this.$selectionBase.css("background-color",t.toHexString()),this.$opacityGradient.css("background-image","-webkit-gradient(linear, 0% 0%, 0% 100%, from("+o+"), to(transparent))"),this.$hueSelector.css("bottom",this._hsv.h/360*100+"%"),this.$opacitySelector.css("bottom",100*this._hsv.a+"%"),isNaN(this._hsv.s)||(this._hsv.s=100*this._hsv.s+"%"),isNaN(this._hsv.v)||(this._hsv.v=100*this._hsv.v+"%"),this.$selectionBase.css({left:this._hsv.s,bottom:this._hsv.v})},o.prototype.focus=function(){return this.$selectionBase.is(":focus")?!1:(this.$selectionBase.focus(),!0)},o.prototype.getColor=function(){return this._color},o.prototype._updateColorTypeRadioButtons=function(e){switch(this.$buttonList.find("li").removeClass("selected"),e){case"rgb":this.$buttonList.find(".rgba").parent().addClass("selected");break;case"hex":case"name":this.$buttonList.find(".hex").parent().addClass("selected");break;case"hsl":this.$buttonList.find(".hsla").parent().addClass("selected")}},o.prototype._bindColorFormatToRadioButton=function(e){var t,o=this;t=function(e){var t,r,n;switch(n=$(e.currentTarget).html().toLowerCase().replace("%","p"),r=o.getColor(),t=tinycolor(r),n){case"hsla":r=t.toHslString();break;case"rgba":r=t.toRgbString();break;case"prgba":r=t.toPercentageRgbString();break;case"hex":r=t.toHexString(),o._hsv.a=1}o._commitColor(r,!1)},this.$element.find("."+e).click(t)},o.prototype._bindOriginalColorButton=function(){var e=this;this.$originalColor.click(function(){e._commitColor(e._originalColor,!0)})},o.prototype._convertToNormalRGB=function(e){var t=e.match(/^rgb.*?([0-9]+)\%.*?([0-9]+)\%.*?([0-9]+)\%/);if(t){var o,r,n;for(o=0;3>o;o++)r=t[o+1],n=Math.round(255*Number(r)/100),isNaN(n)||(e=e.replace(r+"%",n))}return e},o.prototype._normalizeColorString=function(e){var t=e;return e.match(/^#[0-9a-fA-F]{6}/)?tinycolor(e).toString():(e.match(/^(rgb|hsl)/)&&(t=t.replace(/,\s*/g,", "),t=t.replace(/\(\s+/,"("),t=t.replace(/\s+\)/,")")),t.toLowerCase())},o.prototype._handleTextFieldInput=function(e){var t=$.trim(this.$colorValue.val()),o=tinycolor(t),r=o.ok;r&&(r=o.toString()===this._normalizeColorString(t)),e&&!r&&(t=this.getColor().toString()),(e||r)&&this._commitColor(t,!0)},o.prototype._bindInputHandlers=function(){var e=this;this.$colorValue.bind("input",function(){e._handleTextFieldInput(!1)}),this.$colorValue.bind("change",function(){e._handleTextFieldInput(!0)})},o.prototype._addSwatches=function(e){var t=this;e.forEach(function(e){var o=e.count>1?s.COLOR_EDITOR_USED_COLOR_TIP_PLURAL:s.COLOR_EDITOR_USED_COLOR_TIP_SINGULAR,r=i.format(o,e.value,e.count);t.$swatches.append("<li tabindex='0'><div class='swatch-bg'><div class='swatch' style='background-color: "+e.value+";' title='"+r+"'></div></div> <span class='value' title='"+r+"'>"+e.value+"</span></li>")}),this.$swatches.find("li").keydown(function(e){if(e.keyCode===n.DOM_VK_RETURN||e.keyCode===n.DOM_VK_ENTER||e.keyCode===n.DOM_VK_SPACE)t._commitColor($(e.currentTarget).find(".value").html());else if(e.keyCode===n.DOM_VK_TAB&&!e.shiftKey&&0===$(this).next("li").length)return t.$selectionBase.focus(),!1}),this.$swatches.find("li").click(function(e){t._commitColor($(e.currentTarget).find(".value").html())})},o.prototype.setColorAsHsv=function(e){var t,o,r;switch(r=tinycolor(this.getColor()).format,$.extend(this._hsv,e),o=tinycolor(this._hsv),r){case"hsl":t=o.toHslString();break;case"rgb":t=o.toRgbString();break;case"prgb":t=o.toPercentageRgbString();break;case"hex":case"name":t=this._hsv.a<1?o.toRgbString():o.toHexString()}this._commitColor(t,!1)},o.prototype._commitColor=function(e,t){var o;void 0===t&&(t=!0),this._callback(e),this._color=e,t&&(o=tinycolor(e),this._hsv=o.toHsv(),this._color=o),this._redoColor=null,this._synchronize()},o.prototype.setColorFromString=function(e){this._commitColor(e,!0)},o.prototype._handleSelectionFieldDrag=function(e){var t,o,n,i,s;t=this.$selection.height(),n=this.$selection.width(),i=r(e.clientX,this.$selection.offset().left,n),s=r(e.clientY,this.$selection.offset().top,t),o={},o.s=i/n,o.v=1-s/t,this.setColorAsHsv(o,!1),this.$selection.find(".selector-base").is(":focus")||this.$selection.find(".selector-base").focus()},o.prototype._handleHueDrag=function(e){var t,o,n;t=this.$hueSlider.height(),n=r(e.clientY,this.$hueSlider.offset().top,t),o={},o.h=360*(1-n/t),this.setColorAsHsv(o,!1),this.$hueSlider.find(".selector-base").is(":focus")||this.$hueSlider.find(".selector-base").focus()},o.prototype._handleOpacityDrag=function(e){var t,o,n;t=this.$opacitySlider.height(),n=r(e.clientY,this.$opacitySlider.offset().top,t),o={},o.a=1-n/t,this.setColorAsHsv(o,!1),this.$opacitySlider.find(".selector-base").is(":focus")||this.$opacitySlider.find(".selector-base").focus()},o.prototype._registerDragHandler=function(e,t){var o=function(){$(window).unbind("mousemove",t),$(window).unbind("mouseup",o)};e.mousedown(function(){$(window).bind("mousemove",t),$(window).bind("mouseup",o)}),e.mousedown(t)},o.prototype.undo=function(){if(this._originalColor.toString()!==this._color.toString()){var e=this._color.toString();this._commitColor(this._originalColor,!0),this._redoColor=e}},o.prototype.redo=function(){this._redoColor&&(this._commitColor(this._redoColor,!0),this._redoColor=null)},o.prototype._handleKeydown=function(e){var t="win"===brackets.platform?e.ctrlKey:e.metaKey;if(t)switch(e.keyCode){case n.DOM_VK_Z:return e.shiftKey?this.redo():this.undo(),!1;case n.DOM_VK_Y:return this.redo(),!1}else if(e.keyCode===n.DOM_VK_LEFT||e.keyCode===n.DOM_VK_RIGHT||e.keyCode===n.DOM_VK_UP||e.keyCode===n.DOM_VK_DOWN){var o=!1,r=$(e.target);if(r.is("input:not([type])")||r.is("input[type=text]")?r[0].selectionStart===r[0].selectionEnd&&(e.keyCode===n.DOM_VK_LEFT&&0===r[0].selectionStart||e.keyCode===n.DOM_VK_RIGHT&&r[0].selectionEnd===r.val().length)&&(o=!0):o=!0,o)return e.stopPropagation(),!1}},o.prototype._handleHslKeydown=function(e){return e.keyCode!==n.DOM_VK_TAB||e.shiftKey||0!==this.$swatches.children().length?void 0:(this.$selectionBase.focus(),!1)},o.prototype._handleSelectionKeydown=function(e){var t,o,r,i={},s=1.5;switch(e.keyCode){case n.DOM_VK_LEFT:case n.DOM_VK_RIGHT:return s=e.shiftKey?s*l:s,t=Number($.trim(this.$selectionBase[0].style.left.replace("%",""))),r=e.keyCode===n.DOM_VK_LEFT?t-s:t+s,t=Math.min(100,Math.max(0,r)),i.s=t/100,this.setColorAsHsv(i,!1),!1;case n.DOM_VK_DOWN:case n.DOM_VK_UP:return s=e.shiftKey?s*l:s,o=Number($.trim(this.$selectionBase[0].style.bottom.replace("%",""))),r=e.keyCode===n.DOM_VK_DOWN?o-s:o+s,o=Math.min(100,Math.max(0,r)),i.v=o/100,this.setColorAsHsv(i,!1),!1;case n.DOM_VK_TAB:if(e.shiftKey)return 0===this.$swatches.children().length?this.$hslButton.focus():this.$swatches.find("li:last").focus(),!1}},o.prototype._handleHueKeydown=function(e){var t={},o=Number(this._hsv.h),r=3.6;switch(e.keyCode){case n.DOM_VK_DOWN:return r=e.shiftKey?r*l:r,t.h=0>=o-r?360-r:o-r,this.setColorAsHsv(t,!1),!1;case n.DOM_VK_UP:return r=e.shiftKey?r*l:r,t.h=o+r>=360?r:o+r,this.setColorAsHsv(t,!1),!1}},o.prototype._handleOpacityKeydown=function(e){var t=this._hsv.a,o={},r=.01;switch(e.keyCode){case n.DOM_VK_DOWN:return r=e.shiftKey?r*l:r,t>0&&(o.a=0>=t-r?0:t-r,this.setColorAsHsv(o)),!1;case n.DOM_VK_UP:return r=e.shiftKey?r*l:r,100>t&&(o.a=t+r>=1?1:t+r,this.setColorAsHsv(o)),!1}},o.prototype._bindKeyHandler=function(e,t){e.bind("keydown",t)},$(window.document).on("mousedown",".color-selection-field, .slider, .large-swatch",function(e){e.preventDefault()}),t.ColorEditor=o}),define("InlineColorEditor",["require","exports","module","ColorEditor"],function(e,t,o){function r(e,t,o){this._color=e,this._startBookmark=t,this._endBookmark=o,this._isOwnChange=!1,this._isHostChange=!1,this._origin="+InlineColorEditor_"+d++,this._handleColorChange=this._handleColorChange.bind(this),this._handleHostDocumentChange=this._handleHostDocumentChange.bind(this),i.call(this)}function n(e,t){return e.count===t.count?0:e.count>t.count?-1:e.count<t.count?1:void 0}var i=brackets.getModule("editor/InlineWidget").InlineWidget,s=e("ColorEditor").ColorEditor,a=brackets.getModule("utils/ColorUtils"),l=7,d=1;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.parentClass=i.prototype,r.prototype.colorEditor=null,r.prototype._color=null,r.prototype._startBookmark=null,r.prototype._endBookmark=null,r.prototype._isOwnChange=null,r.prototype._isHostChange=null,r.prototype._origin=null,r.prototype.getCurrentRange=function(){var e,t;if(e=this._startBookmark.find(),!e)return null;t=this._endBookmark.find(),t||(t={line:e.line});var o=this.hostEditor.document.getLine(e.line),r=o.substr(e.ch).match(a.COLOR_REGEX);return r&&(void 0===t.ch||t.ch-e.ch<r[0].length)&&(t.ch=e.ch+r[0].length,this._endBookmark.clear(),this._endBookmark=this.hostEditor._codeMirror.setBookmark(t)),void 0===t.ch?null:{start:e,end:t}},r.prototype._handleColorChange=function(e){var t=this;if(e!==this._color){var o=this.getCurrentRange();if(!o)return;this._isHostChange||(this._isOwnChange=!0,this.hostEditor.document.batchOperation(function(){t.hostEditor.document.replaceRange(e,o.start,o.end,t._origin),t.hostEditor.setSelection(o.start,{line:o.start.line,ch:o.start.ch+e.length})}),this._isOwnChange=!1),this._color=e}},r.prototype.load=function(){r.prototype.parentClass.load.apply(this,arguments);var e=this.hostEditor.document.getText().match(a.COLOR_REGEX),t=this._collateColors(e,l);this.colorEditor=new s(this.$htmlContent,this._color,this._handleColorChange,t)},r.prototype.onAdded=function(){r.prototype.parentClass.onAdded.apply(this,arguments);var e=this.hostEditor.document;e.addRef(),$(e).on("change",this._handleHostDocumentChange),this.hostEditor.setInlineWidgetHeight(this,this.colorEditor.getRootElement().outerHeight(),!0),this.colorEditor.focus()},r.prototype.onClosed=function(){r.prototype.parentClass.onClosed.apply(this,arguments),this._startBookmark&&this._startBookmark.clear(),this._endBookmark&&this._endBookmark.clear();var e=this.hostEditor.document;$(e).off("change",this._handleHostDocumentChange),e.releaseRef()},r.prototype._collateColors=function(e,t){var o={};e.forEach(function(e){var t=e.toLowerCase();o[t]?o[t].count++:o[t]={value:e,count:1}});var r=$.map(o,function(e){return e});return r.sort(n),r.slice(0,t)},r.prototype._handleHostDocumentChange=function(){if(!this._isOwnChange){var e=this.getCurrentRange();if(e){var t=this.hostEditor.document.getRange(e.start,e.end);t!==this._color&&(this._isHostChange=!0,this.colorEditor.setColorFromString(t),this._isHostChange=!1)}else this.close()}},o.exports.InlineColorEditor=r}),define("main",["require","exports","module","InlineColorEditor"],function(e,t,o){function r(e,t){var o,r,n,i,s,a,d,c;if(i=e.getSelection(),i.start.line!==i.end.line)return null;o=new RegExp(l.COLOR_REGEX),r=e.document.getLine(t.line);do n=o.exec(r),n&&(s=n.index,a=s+n[0].length);while(n&&(t.ch<s||t.ch>a));return n?(t.ch=s,d=e._codeMirror.setBookmark(t),c=e._codeMirror.setBookmark({line:t.line,ch:a}),e.setSelection(t,{line:t.line,ch:a}),{color:n[0],start:d,end:c}):null}function n(e,t){var o,n,i=r(e,t);return i?(o=new a(i.color,i.start,i.end),o.load(e),n=new $.Deferred,n.resolve(o),n.promise()):null}var i=brackets.getModule("editor/EditorManager"),s=brackets.getModule("utils/ExtensionUtils"),a=e("InlineColorEditor").InlineColorEditor,l=brackets.getModule("utils/ColorUtils");s.loadStyleSheet(o,"css/main.less"),i.registerInlineEditProvider(n),t.prepareEditorForProvider=r,t.inlineColorEditorProvider=n});